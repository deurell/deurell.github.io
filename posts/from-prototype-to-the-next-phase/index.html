<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>From Prototype to the Next Phase | Deurell Labs</title>



<link href="https://deurell.github.io/index.xml" rel="alternate" type="application/rss+xml" title="Deurell Labs">

<link rel="stylesheet" href="/css/style.css">

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<link rel="canonical" href="https://deurell.github.io/posts/from-prototype-to-the-next-phase/">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>

<section class="section">
  <div class="container">
    <nav id="nav-main" class="nav">
      <div id="nav-name" class="nav-left">
        <a id="nav-anchor" class="nav-item" href="https://deurell.github.io">
          <h1 id="nav-heading" class="title is-4">Deurell Labs</h1>
        </a>
      </div>
      <div class="nav-right">
        <nav id="nav-items" class="nav-item level is-mobile"><a class="level-item" aria-label="twitter" href='https://twitter.com/deurell'
            target='_blank' rel='me noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
    
  </svg>
</i>
            </span>
          </a><a class="level-item" aria-label="github" href='https://github.com/deurell'
            target='_blank' rel='me noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
    
  </svg>
</i>
            </span>
          </a><a class="level-item" aria-label="email" href='mailto:dev@deurell.net'
            target='_blank' rel='me noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
    <polyline points="22,6 12,13 2,6"/>
    
  </svg>
</i>
            </span>
          </a><a class="level-item" aria-label="linkedin" href='https://linkedin.com/in/deurell'
            target='_blank' rel='me noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path stroke-width="1.8" d="m5.839218,4.101561c0,1.211972 -0.974141,2.194011 -2.176459,2.194011s-2.176459,-0.982039 -2.176459,-2.194011c0,-1.211094 0.974141,-2.194011 2.176459,-2.194011s2.176459,0.982917 2.176459,2.194011zm0.017552,3.94922l-4.388022,0l0,14.04167l4.388022,0l0,-14.04167zm7.005038,0l-4.359939,0l0,14.04167l4.360816,0l0,-7.370999c0,-4.098413 5.291077,-4.433657 5.291077,0l0,7.370999l4.377491,0l0,-8.89101c0,-6.915523 -7.829986,-6.66365 -9.669445,-3.259423l0,-1.891237z"/>
    
  </svg>
</i>
            </span>
          </a></nav>
      </div>
    </nav>

    <nav class="nav">
      

      
    </nav>

  </div>
  <script src="/js/navicon-shift.js"></script>
</section>

<section class="section">
  <div class="container">
    <div class="subtitle tags is-6 is-pulled-right">
      
      
<a class="subtitle is-6" href="/tags/swift/">#Swift</a>



  
  | <a class="subtitle is-6" href="/tags/typehike/">#TypeHike</a>
  


      
    </div>
    <h2 class="subtitle is-6">August 25, 2023</h2>
    <h1 class="title">From Prototype to the Next Phase</h1>
    
    <div class="content">
      <p>Starting a new project often comes with the desire for perfection right from the get-go. However, I&rsquo;ve always found immense value in beginning with a rough prototype, whether it was for my recent multiplayer Unreal 5 networking implementation gig for a First Person Shooter, fancy Candy Crush features, or that quirky AR game I spent way too much time and energy on. My latest endeavor? A super simple text adventure game engine. Let&rsquo;s dive into this weird journey.</p>
<h3 id="1-the-birth-of-the-prototype"><strong>1. The Birth of the Prototype</strong></h3>
<p>Like many of my projects, this text adventure game began as a simple prototype. The aim was clear: get something functional, and quickly. The code was linear, functions were lengthy, and everything was bundled in a single file. It was the Wild West of coding, where quick fixes and hacks were the norm.</p>
<p><strong>Why start with a prototype?</strong></p>
<ul>
<li><strong>Rapid Development</strong>: Witness immediate results.</li>
<li><strong>Flexibility</strong>: Experiment without the constraints of a rigid structure.</li>
<li><strong>Understanding</strong>: Grasp the core mechanics and requirements of the project.</li>
</ul>
<h3 id="2-the-need-for-refactoring"><strong>2. The Need for Refactoring</strong></h3>
<p>As the game&rsquo;s complexity grew, so did the intricacies of the prototype. Maintenance became a challenge, and introducing new features felt like navigating a lovely maze. A revamp was clearly in order.</p>
<h3 id="3-the-evolution-key-structural-changes"><strong>3. The Evolution: Key Structural Changes</strong></h3>
<p><strong>a. Modular Design</strong></p>
<ul>
<li>
<p><strong>Before</strong>: The prototype was characterized by a monolithic structure where functions and data were all housed within a single file. This made the code harder to navigate and maintain. For instance, the game&rsquo;s state, command resolution, and game logic were all mixed together:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> gameRooms: [Int: Room] = [:]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> currentRoomID = <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> playerInventory: [Item] = []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">resolveAlias</span>(<span style="color:#66d9ef">_</span> command: String) -&gt; String {...}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">loadGameData</span>(from filename: String) {...}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">lookAround</span>(<span style="color:#66d9ef">in</span> room: Room) {...}
</span></span></code></pre></div><p>This approach, while quick to implement, doesn&rsquo;t scale well. As the game&rsquo;s complexity grew, so did the challenges in managing and extending the code.</p>
</li>
<li>
<p><strong>After</strong>: The refactored version adopted a modular design, breaking down the game&rsquo;s functionalities into distinct classes. This not only made the code more organized but also more maintainable and scalable:</p>
<ul>
<li>
<p><code>AdventureEngine</code>: This class acts as the main engine driving the game. It initializes the game state, processes commands, and manages the game loop.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AdventureEngine</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> gameState: GameState
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> commandParser: CommandParser
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p><code>CommandParser</code>: Responsible for parsing user input and translating it into recognizable commands for the game engine.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CommandParser</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> gameState: GameState
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> commands: [String: Command] = ...
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li>
<p><code>GameState</code>: This class encapsulates the current state of the game, including the current room, available rooms, and player inventory. It provides a centralized place to manage and query the game&rsquo;s state.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GameState</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> currentRoomID: Int
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> gameRooms: [Int: Room]
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> playerInventory: [Item]
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
</ul>
<p>By segregating functionalities into specific classes, the code became more modular. Each class has a clear responsibility, making it easier to understand, debug, and extend.</p>
</li>
</ul>
<p><strong>b. Command Pattern</strong></p>
<ul>
<li><strong>Before</strong>: A lengthy series of <code>if-else</code> statements to decipher user commands.
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> command == <span style="color:#e6db74">&#34;go&#34;</span> {...}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> command == <span style="color:#e6db74">&#34;get&#34;</span> {...}
</span></span></code></pre></div></li>
<li><strong>After</strong>: The Command pattern was employed, segregating each command into a distinct class, streamlining the addition of new commands.
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">GoCommand</span>: Command {...}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">GetCommand</span>: Command {...}
</span></span></code></pre></div></li>
</ul>
<p><strong>c. Enhanced Data Structures</strong></p>
<ul>
<li><strong>Before</strong>: Basic structures with limited adaptability.
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Room</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> description: String
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> items: [String]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
<li><strong>After</strong>: Introduced more comprehensive structures like <code>Path</code>, <code>Item</code>, <code>Character</code>, and others, enabling more intricate game interactions.
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Path</span>: Codable {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> roomID: Int
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> isLocked: Bool
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Item</span>: Codable {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> name: String
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> description: String
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
</ul>
<h3 id="4-the-benefits-of-the-new-design"><strong>4. The Benefits of the New Design</strong></h3>
<ul>
<li><strong>Scalability</strong>: The revamped structure is primed for expansion.</li>
<li><strong>Maintainability</strong>: Debugging is simplified, and feature integration is streamlined.</li>
<li><strong>Clarity</strong>: The code&rsquo;s readability has been enhanced.</li>
</ul>
<h3 id="5-diving-into-the-swift-package-manager-spm"><strong>5. Diving into the Swift Package Manager (SPM)</strong></h3>
<p>The game engine is structured as an SPM package. SPM is a tool for managing the distribution of Swift code, making it easy to share and consume libraries. Here&rsquo;s the entire <code>Package.swift</code> file for a deeper look:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">PackageDescription</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">let</span> package = Package(
</span></span><span style="display:flex;"><span>    name: <span style="color:#e6db74">&#34;TypeHike&#34;</span>,
</span></span><span style="display:flex;"><span>    products: [
</span></span><span style="display:flex;"><span>        .library(
</span></span><span style="display:flex;"><span>            name: <span style="color:#e6db74">&#34;TypeHike&#34;</span>,
</span></span><span style="display:flex;"><span>            targets: [<span style="color:#e6db74">&#34;TypeHike&#34;</span>]
</span></span><span style="display:flex;"><span>        ),
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    targets: [
</span></span><span style="display:flex;"><span>        .target(
</span></span><span style="display:flex;"><span>            name: <span style="color:#e6db74">&#34;TypeHike&#34;</span>,
</span></span><span style="display:flex;"><span>            path: <span style="color:#e6db74">&#34;Sources&#34;</span>,
</span></span><span style="display:flex;"><span>            resources: [.process(<span style="color:#e6db74">&#34;Resources&#34;</span>)]
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><h3 id="6-the-takeaway"><strong>6. The Takeaway</strong></h3>
<p>Starting with a simple prototype is always super valuable. It served as a sandbox, allowing me to understand the game&rsquo;s mechanics and prerequisites. With this foundation, I could confidently transition to a more refined design. There are plenty of more refactorings to be done and functionality to add. But that&rsquo;s for another day.</p>
<p>To my fellow developers: Dive into the initial chaos with enthusiasm. Learn from the mess, refine, and watch your code evolve towards clarity and structure. Remember, it doesn&rsquo;t have to be perfect from the start; it just needs to progress. Keep coding!</p>
<p><a href="https://github.com/deurell/TypeHike"><img src="https://img.shields.io/badge/GitHub-View%20on%20GitHub-blue" alt="GitHub"></a></p>
<p><img src="/dungeon.png" alt="Adventure"></p>

      
    </div>
    
  </div>
</section>



<section class="section">
  <div class="container has-text-centered">
    <p></p>
    
  </div>
</section>





</body>
</html>

