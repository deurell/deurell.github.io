<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Teaching your teen to code a starfield in PICO-8 | Deurell Labs</title>
<meta name="keywords" content="pico-8">
<meta name="description" content="Kids love starfields. It&rsquo;s a perfect coding session with a nice visual result and basic highschool math. We&rsquo;re going to build this:
When coding with kids, always keep it simple and at their level. I know most of you reading this are math wizards but kids tend not to be super impressed by your vector math and matrix calculations (believe me, I&rsquo;ve tried). You&rsquo;re going for quick results and simple code, on their math level.">
<meta name="author" content="">
<link rel="canonical" href="https://deurell.github.io/posts/starfield/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.bccfefac377bc340f06c260aed1bddf49a4354816d7c570d6aac75a997986c95.css" integrity="sha256-vM/vrDd7w0DwbCYK7Rvd9JpDVIFtfFcNaqx1qZeYbJU=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://deurell.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://deurell.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://deurell.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://deurell.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://deurell.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Teaching your teen to code a starfield in PICO-8" />
<meta property="og:description" content="Kids love starfields. It&rsquo;s a perfect coding session with a nice visual result and basic highschool math. We&rsquo;re going to build this:
When coding with kids, always keep it simple and at their level. I know most of you reading this are math wizards but kids tend not to be super impressed by your vector math and matrix calculations (believe me, I&rsquo;ve tried). You&rsquo;re going for quick results and simple code, on their math level." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://deurell.github.io/posts/starfield/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-04-10T16:59:21+02:00" />
<meta property="article:modified_time" content="2019-04-10T16:59:21+02:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Teaching your teen to code a starfield in PICO-8"/>
<meta name="twitter:description" content="Kids love starfields. It&rsquo;s a perfect coding session with a nice visual result and basic highschool math. We&rsquo;re going to build this:
When coding with kids, always keep it simple and at their level. I know most of you reading this are math wizards but kids tend not to be super impressed by your vector math and matrix calculations (believe me, I&rsquo;ve tried). You&rsquo;re going for quick results and simple code, on their math level."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://deurell.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Teaching your teen to code a starfield in PICO-8",
      "item": "https://deurell.github.io/posts/starfield/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Teaching your teen to code a starfield in PICO-8",
  "name": "Teaching your teen to code a starfield in PICO-8",
  "description": "Kids love starfields. It\u0026rsquo;s a perfect coding session with a nice visual result and basic highschool math. We\u0026rsquo;re going to build this:\nWhen coding with kids, always keep it simple and at their level. I know most of you reading this are math wizards but kids tend not to be super impressed by your vector math and matrix calculations (believe me, I\u0026rsquo;ve tried). You\u0026rsquo;re going for quick results and simple code, on their math level.",
  "keywords": [
    "pico-8"
  ],
  "articleBody": "Kids love starfields. It’s a perfect coding session with a nice visual result and basic highschool math. We’re going to build this:\nWhen coding with kids, always keep it simple and at their level. I know most of you reading this are math wizards but kids tend not to be super impressed by your vector math and matrix calculations (believe me, I’ve tried). You’re going for quick results and simple code, on their math level. If you push them too hard you’ll loose them to another Overwatch session. We’re trying to avoid that.\nA star object is a 3D vector, that’s math for a basic x,y,z coordinate in space. [1,2,3] would be a star at x=1, y=2, z=3 in space. We will have a bunch of star objects with random x,y,z coordinates. Since we want them to move towards us we just decrease the z coordinate for each star every frame, keeping their x and y coordinate intact. In order to get it to look like a starfield we simply calculate the x and y screen coordinate by dividing the star x and y coordinate with z. Big z will give us small x and y screen coordinates. Small Z will give us the opposite. We’ll keep the x and y coordinates for a star in the range -2500 to 2500 and the z in the range 0 to 150 A quick and dirty perspective divide. That’s all the math. It looks like this.\nYou can see the x,y,z star coordinates for the star below the star screen coordinates which are just x and y divided by z.\nLet’s start by adding the following code in the code tab.\n-- this is called once when the program starts function _init() -- calls our starfield init code and sets up all the stars sf.generate() end -- normal pico8 frame rate is 30 -- add this function to get 60 fps function _update60() end -- called every frame function _draw() -- clear screen with black cls(0) -- update the starfield sf.update() end We’ll put the starfield code in another pico-8 code tab. You can copy and pase the code below.\nsf={} sf.stars={} -- let's have 128 stars sf.starcount=128 -- max z for a star is 150 sf.maxd=150 sf.generate=function() local range=2500 --create table with stars for i=1,sf.starcount do --keep x any y in ranmge -2500 to 2500 xp=flr(range-rnd(range*2)) yp=flr(range-rnd(range*2)) zp=rnd(sf.maxd) add(sf.stars,{x=xp,y=yp,z=zp}) end end sf.update=function() for i=1,#sf.stars do sf.stars[i].z=sf.stars[i].z-1 if sf.stars[i].z\u003c=0 then sf.stars[i].z=sf.maxd end end --iterate all the stars for i=1,#sf.stars do --calc star pos xp=x/z yp=y/z local cz=sf.stars[i].z local cx=sf.stars[i].x/cz local cy=sf.stars[i].y/cz --if star is outside sceen --set z position to max dist if cx\u003c-64 or cx\u003e64 then sf.stars[i].z=sf.maxd end if cy\u003c-64 or cy\u003e64 then sf.stars[i].z=sf.maxd end --set the color of the star local cols={7,6,5} local ci=1+flr(cz/sf.maxd*#cols) --plot the star pset(64+cx,64+cy,cols[ci]) end end And that’s it. A star field project in PICO-8. It’s a two hour session for a 14 year old including setting up pico-8, explaining basic Lua and writing the project.\nSource code and cartridge is available here https://www.lexaloffle.com/bbs/?tid=33840\nPICO-8 is available from here https://www.lexaloffle.com/pico-8.php\n",
  "wordCount" : "514",
  "inLanguage": "en",
  "datePublished": "2019-04-10T16:59:21+02:00",
  "dateModified": "2019-04-10T16:59:21+02:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://deurell.github.io/posts/starfield/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Deurell Labs",
    "logo": {
      "@type": "ImageObject",
      "url": "https://deurell.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://deurell.github.io" accesskey="h" title="Deurell Labs (Alt + H)">Deurell Labs</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Teaching your teen to code a starfield in PICO-8
    </h1>
    <div class="post-meta"><span title='2019-04-10 16:59:21 +0200 CEST'>April 10, 2019</span>

</div>
  </header> 
  <div class="post-content"><p>Kids love starfields. It&rsquo;s a perfect coding session with a nice visual result and basic highschool math. We&rsquo;re going to build this:</p>
<p><img loading="lazy" src="/starfield.gif" alt="starfield"  />
</p>
<p>When coding with kids, always keep it simple and at their level. I know most of you reading this are math wizards but kids tend not to be super impressed by your vector math and matrix calculations (believe me, I&rsquo;ve tried). You&rsquo;re going for quick results and simple code, on their math level. If you push them too hard you&rsquo;ll loose them to another Overwatch session. We&rsquo;re trying to avoid that.</p>
<p>A star object is a 3D vector, that&rsquo;s math for a basic x,y,z coordinate in space. [1,2,3] would be a star at x=1, y=2, z=3 in space. We will have a bunch of star objects with random x,y,z coordinates. Since we want them to move towards us we just decrease the z coordinate for each star every frame, keeping their x and y coordinate intact. In order to get it to look like a starfield we simply calculate the x and y screen coordinate by dividing the star x and y coordinate with z. Big z will give us small x and y screen coordinates. Small Z will give us the opposite. We&rsquo;ll keep the x and y coordinates for a star in the range -2500 to 2500 and the z in the range 0 to 150 A quick and dirty perspective divide. That&rsquo;s all the math. It looks like this.</p>
<p><img loading="lazy" src="/starfield_debug.gif" alt="starfield debug"  />
</p>
<p>You can see the x,y,z star coordinates for the star below the star screen coordinates which are just x and y divided by z.</p>
<p>Let&rsquo;s start by adding the following code in the code tab.</p>
<pre tabindex="0"><code>-- this is called once when the program starts
function _init()
 -- calls our starfield init code and sets up all the stars
 sf.generate()
end

-- normal pico8 frame rate is 30
-- add this function to get 60 fps
function _update60()
end

-- called every frame
function _draw()
 -- clear screen with black
 cls(0)
 -- update the starfield
 sf.update()
end
</code></pre><p>We&rsquo;ll put the starfield code in another pico-8 code tab. You can copy and pase the code below.</p>
<pre tabindex="0"><code>sf={}
sf.stars={}
-- let&#39;s have 128 stars
sf.starcount=128
-- max z for a star is 150
sf.maxd=150

sf.generate=function()
local range=2500
  --create table with stars
  for i=1,sf.starcount do
  	--keep x any y in ranmge -2500 to 2500
    xp=flr(range-rnd(range*2))
    yp=flr(range-rnd(range*2))
    zp=rnd(sf.maxd)
    add(sf.stars,{x=xp,y=yp,z=zp})
  end
end

sf.update=function()
  for i=1,#sf.stars do
    sf.stars[i].z=sf.stars[i].z-1
    if sf.stars[i].z&lt;=0 then
	  sf.stars[i].z=sf.maxd
    end
  end
  --iterate all the stars
  for i=1,#sf.stars do
    --calc star pos xp=x/z yp=y/z
	local cz=sf.stars[i].z
	local cx=sf.stars[i].x/cz
	local cy=sf.stars[i].y/cz
	--if star is outside sceen
	--set z position to max dist
	if cx&lt;-64 or cx&gt;64 then
	  sf.stars[i].z=sf.maxd
	end
	if cy&lt;-64 or cy&gt;64 then
	  sf.stars[i].z=sf.maxd
	end
	--set the color of the star
	local cols={7,6,5}
	local ci=1+flr(cz/sf.maxd*#cols)
	--plot the star
	  pset(64+cx,64+cy,cols[ci])
  end
end
</code></pre><p>And that&rsquo;s it. A star field project in PICO-8. It&rsquo;s a two hour session for a 14 year old including setting up pico-8, explaining basic Lua and writing the project.</p>
<p>Source code and cartridge is available here <a href="https://www.lexaloffle.com/bbs/?tid=33840">https://www.lexaloffle.com/bbs/?tid=33840</a></p>
<p>PICO-8 is available from here <a href="https://www.lexaloffle.com/pico-8.php">https://www.lexaloffle.com/pico-8.php</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://deurell.github.io/tags/pico-8/">pico-8</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://deurell.github.io">Deurell Labs</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
